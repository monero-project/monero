// Copyright (c) 2024, The Monero Project
//
// All rights reserved.
//
// Redistribution and use in source and binary forms, with or without modification, are
// permitted provided that the following conditions are met:
//
// 1. Redistributions of source code must retain the above copyright notice, this list of
//    conditions and the following disclaimer.
//
// 2. Redistributions in binary form must reproduce the above copyright notice, this list
//    of conditions and the following disclaimer in the documentation and/or other
//    materials provided with the distribution.
//
// 3. Neither the name of the copyright holder nor the names of its contributors may be
//    used to endorse or promote products derived from this software without specific
//    prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL
// THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
// STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF
// THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

#pragma once

#include "cryptonote_config.h"

namespace fcmp_pp
{
//----------------------------------------------------------------------------------------------------------------------

static_assert(FCMP_PLUS_PLUS_MAX_INPUTS == 128, "FCMP++ proof len table expects max 128 inputs");

// Constructed using ::_slow_membership_proof_size
static const uint32_t PROOF_LEN_TABLE[FCMP_PLUS_PLUS_MAX_INPUTS][FCMP_PLUS_PLUS_MAX_LAYERS]
{
    {2880, 3296, 3520, 4064, 4416, 4832, 5056, 5600, 5248, 4768, 4960, 5312, },
    {3680, 4640, 4288, 5120, 5632, 5376, 5888, 6336, 6144, 5696, 6048, 6432, },
    {3360, 4736, 5312, 5728, 5408, 5472, 6016, 6592, 6976, 7552, 7424, 7136, },
    {3744, 5664, 5504, 5824, 6528, 6464, 7168, 7808, 7808, 7552, 8096, 8672, },
    {4288, 5728, 5408, 6016, 6784, 7744, 7616, 7680, 8256, 9024, 9600, 10208, },
    {3424, 5216, 6144, 6656, 6688, 7104, 7744, 8672, 9408, 10208, 10304, 10496, },
    {3616, 5632, 5856, 6656, 7456, 7904, 8832, 9792, 9888, 10144, 10912, 11712, },
    {3808, 6176, 6400, 7104, 8192, 8512, 9600, 10624, 11008, 11136, 12064, 13024, },
    {4160, 6016, 6112, 6976, 8096, 9440, 9728, 10176, 11136, 12288, 13248, 14368, },
    {4352, 6272, 6496, 7520, 8832, 10208, 10496, 11104, 12224, 13408, 14400, 15680, },
    {3456, 5696, 7040, 8096, 8544, 9536, 10720, 11904, 13056, 14400, 15712, 16352, },
    {3488, 5920, 7424, 8512, 9120, 10112, 11328, 12832, 14144, 15520, 16192, 16960, },
    {3648, 6272, 7808, 9056, 9696, 10720, 12096, 13632, 14976, 15968, 16768, 18112, },
    {3680, 6496, 7328, 8736, 10272, 11456, 12864, 14560, 15392, 16384, 17760, 19296, },
    {3840, 6848, 7712, 9152, 10848, 12064, 13632, 15360, 16192, 17216, 18752, 20448, },
    {3872, 7072, 8064, 9536, 11392, 12480, 14336, 16128, 17280, 18176, 19872, 21600, },
    {4064, 6752, 7744, 9376, 11136, 13216, 14400, 15648, 17408, 19296, 21024, 22784, },
    {4224, 6944, 7968, 9760, 11680, 13824, 15168, 16416, 18176, 20256, 22144, 23936, },
    {4256, 7168, 8352, 10304, 12256, 14560, 15776, 17184, 19264, 21216, 23136, 25248, },
    {4416, 7360, 8544, 10528, 12800, 15136, 16384, 17952, 20032, 22176, 24128, 26368, },
    {4448, 7712, 8928, 10944, 12512, 15008, 17120, 18720, 20864, 23168, 25280, 27552, },
    {3520, 6816, 9152, 11456, 12896, 14880, 17184, 19488, 21632, 24096, 26400, 28160, },
    {3520, 7008, 9504, 11840, 13472, 15456, 17760, 20256, 22720, 25216, 26848, 28480, },
    {3552, 7200, 9856, 12096, 13856, 16000, 18368, 21024, 23488, 26016, 27840, 29760, },
    {3712, 7552, 10240, 12640, 14432, 16608, 19104, 21792, 24320, 27008, 28960, 30912, },
    {3712, 7584, 10304, 12992, 14816, 17024, 19840, 22560, 25088, 27392, 29248, 31904, },
    {3744, 7808, 10688, 13408, 15360, 17728, 20448, 23328, 25504, 27680, 30368, 33088, },
    {3744, 7968, 10144, 12896, 15776, 18304, 21056, 24096, 26272, 28608, 31328, 34208, },
    {3904, 8320, 10496, 13280, 16192, 18720, 21760, 24864, 27072, 29440, 32320, 35200, },
    {3904, 8352, 10720, 13664, 16736, 19328, 22528, 25632, 27840, 30368, 33408, 36352, },
    {3936, 8576, 10944, 14048, 17280, 19872, 22976, 26400, 28928, 31328, 34400, 37632, },
    {3936, 8736, 11264, 14272, 17664, 20288, 23680, 27008, 29696, 32128, 35360, 38624, },
    {4096, 8384, 10944, 14112, 17408, 21024, 23744, 26528, 29792, 33216, 36480, 39776, },
    {4128, 8576, 11008, 14464, 17792, 21568, 24192, 27264, 30592, 34176, 37472, 40928, },
    {4128, 8608, 11360, 14720, 18336, 22176, 24960, 27904, 31360, 34976, 38432, 42080, },
    {4288, 8800, 11552, 15072, 18720, 22592, 25664, 28640, 32128, 35936, 39552, 43072, },
    {4288, 8992, 11776, 15456, 19296, 23168, 26112, 29408, 33056, 36736, 40384, 44192, },
    {4320, 9184, 12128, 15840, 19680, 23872, 26848, 30016, 33984, 37696, 41504, 45504, },
    {4320, 9216, 12320, 16192, 20064, 24288, 27584, 30912, 34752, 38784, 42624, 46496, },
    {4480, 9408, 12512, 16416, 20608, 24864, 28032, 31520, 35520, 39584, 43456, 47616, },
    {4512, 9760, 12896, 16832, 20320, 24736, 28768, 32288, 36320, 40512, 44576, 48800, },
    {4512, 9920, 13088, 17184, 20704, 25152, 29344, 33024, 37120, 41504, 45696, 49792, },
    {3584, 9024, 13280, 17408, 21088, 25152, 29408, 33664, 37888, 42304, 46528, 50240, },
    {3584, 9056, 13504, 17920, 21472, 25568, 29984, 34400, 38656, 43232, 47648, 51520, },
    {3584, 9248, 13856, 18304, 22048, 26144, 30560, 35168, 39584, 44192, 48768, 52512, },
    {3584, 9280, 14048, 18528, 22432, 26688, 31136, 35776, 40512, 45152, 49056, 52960, },
    {3616, 9472, 14272, 18912, 22816, 27104, 31872, 36672, 41280, 46080, 50016, 53952, },
    {3616, 9632, 14592, 19136, 23200, 27648, 32320, 37280, 42048, 46880, 51008, 55232, },
    {3616, 9824, 14816, 19520, 23616, 28096, 33056, 38048, 42880, 47872, 52128, 56384, },
    {3776, 10016, 15040, 20032, 24160, 28672, 33632, 38784, 43648, 48800, 53088, 57376, },
    {3776, 10176, 15360, 20256, 24544, 29216, 34208, 39392, 44416, 49600, 54048, 58496, },
    {3776, 10208, 15424, 20608, 24928, 29632, 34944, 40160, 45184, 49984, 54336, 59488, },
    {3776, 10400, 15808, 21024, 25472, 30176, 35392, 40928, 46272, 50944, 55424, 60608, },
    {3808, 10592, 16128, 21248, 25856, 30752, 36128, 41536, 46368, 51200, 56416, 61792, },
    {3808, 10624, 15456, 20864, 26272, 31328, 36704, 42272, 47136, 52000, 57376, 62784, },
    {3808, 10784, 15648, 21088, 26656, 31872, 37312, 43040, 47904, 52928, 58336, 63904, },
    {3968, 11136, 16000, 21472, 27072, 32288, 38016, 43808, 48704, 53728, 59296, 64896, },
    {3968, 11168, 16064, 21824, 27456, 32832, 38464, 44544, 49472, 54688, 60416, 66016, },
    {3968, 11328, 16416, 22080, 27840, 33280, 39200, 45152, 50240, 55488, 61248, 67168, },
    {3968, 11360, 16608, 22432, 28384, 33856, 39936, 45920, 51008, 56416, 62336, 68160, },
    {4000, 11584, 16832, 22816, 28928, 34400, 40384, 46688, 52096, 57376, 63328, 69440, },
    {4000, 11744, 17152, 23040, 29312, 34816, 41088, 47296, 52864, 58176, 64288, 70432, },
    {4000, 11776, 17216, 23392, 29696, 35360, 41536, 48032, 53632, 59104, 65248, 71552, },
    {4000, 11936, 17536, 23616, 30080, 35776, 42240, 48640, 54400, 59904, 66208, 72544, },
    {4160, 11584, 17216, 23456, 29824, 36512, 42304, 48160, 54496, 60992, 67328, 73696, },
    {4160, 11616, 17280, 23808, 30208, 37056, 42752, 48896, 55264, 61792, 68160, 74816, },
    {4160, 11776, 17600, 24032, 30592, 37472, 43456, 49504, 56032, 62720, 69248, 75808, },
    {4192, 11968, 17664, 24384, 30976, 38016, 43904, 50240, 56832, 63680, 70240, 76960, },
    {4192, 12000, 17984, 24608, 31520, 38592, 44640, 50880, 57600, 64480, 71200, 77952, },
    {4192, 12160, 18208, 24992, 31904, 39040, 45376, 51616, 58368, 65408, 72160, 79104, },
    {4192, 12192, 18400, 25216, 32288, 39584, 45824, 52224, 59136, 66240, 73152, 80224, },
    {4352, 12384, 18592, 25568, 32672, 40000, 46528, 52960, 59904, 67168, 74240, 81216, },
    {4352, 12576, 18816, 25952, 33216, 40544, 46976, 53728, 60832, 67968, 75072, 82336, },
    {4352, 12608, 19136, 26176, 33632, 41120, 47680, 54336, 61600, 68896, 76160, 83328, },
    {4384, 12800, 19200, 26528, 34016, 41696, 48288, 55072, 62368, 69696, 77152, 84640, },
    {4384, 12960, 19552, 26912, 34400, 42240, 48864, 55680, 63296, 70656, 78112, 85760, },
    {4384, 12992, 19744, 27264, 34784, 42656, 49600, 56576, 64064, 71744, 79232, 86752, },
    {4384, 13152, 19936, 27488, 35168, 43200, 50048, 57184, 64832, 72544, 80064, 87872, },
    {4544, 13344, 20128, 27840, 35712, 43776, 50752, 57920, 65600, 73472, 81152, 88864, },
    {4544, 13376, 20320, 28064, 36096, 44192, 51200, 58528, 66368, 74272, 81984, 89984, },
    {4544, 13696, 20672, 28448, 36512, 44768, 51936, 59296, 67168, 75200, 83104, 91168, },
    {4576, 13888, 20896, 28832, 36192, 44480, 52512, 60032, 67936, 76000, 84064, 92160, },
    {4576, 13920, 21088, 29056, 36576, 45024, 53088, 60640, 68736, 76960, 85024, 93280, },
    {4576, 14080, 21280, 29408, 36960, 45440, 53664, 61376, 69504, 77920, 86144, 94272, },
    {3488, 13024, 21472, 29632, 37344, 45984, 54240, 61984, 70272, 78720, 86976, 95392, },
    {3648, 13216, 21664, 29984, 37728, 45856, 54304, 62752, 71040, 79648, 88064, 95840, },
    {3648, 13376, 21856, 30208, 38112, 46400, 54880, 63360, 71808, 80448, 88896, 96832, },
    {3648, 13408, 22080, 30720, 38496, 46816, 55456, 64096, 72576, 81376, 90016, 98112, },
    {3648, 13600, 22432, 31104, 39072, 47392, 56032, 64864, 73504, 82176, 90976, 99104, },
    {3648, 13632, 22624, 31328, 39456, 47936, 56608, 65472, 74272, 83264, 91968, 100224, },
    {3648, 13792, 22816, 31680, 39840, 48352, 57184, 66208, 75200, 84224, 93056, 101216, },
    {3648, 13824, 23008, 31904, 40224, 48896, 57760, 66816, 75968, 85024, 93344, 101664, },
    {3680, 14016, 23200, 32256, 40608, 49312, 58336, 67552, 76736, 85952, 94304, 102656, },
    {3680, 14176, 23552, 32512, 40992, 49856, 58944, 68320, 77504, 86752, 95264, 103776, },
    {3680, 14208, 23616, 32864, 41376, 50272, 59648, 69056, 78272, 87680, 96384, 104928, },
    {3680, 14368, 23936, 33088, 41760, 50816, 60096, 69664, 79040, 88480, 97216, 106048, },
    {3680, 14560, 24160, 33472, 42176, 51264, 60832, 70432, 79840, 89440, 98336, 107200, },
    {3680, 14720, 24352, 33824, 42560, 51808, 61408, 71168, 80640, 90400, 99296, 108192, },
    {3680, 14752, 24704, 34208, 43104, 52384, 61984, 71776, 81408, 91200, 100256, 109312, },
    {3840, 14944, 24768, 34560, 43488, 52800, 62560, 72512, 82176, 92128, 101216, 110304, },
    {3840, 15104, 25088, 34784, 43872, 53344, 63136, 73120, 82944, 92928, 102176, 111424, },
    {3840, 15136, 25152, 35136, 44256, 53760, 63712, 73856, 83712, 93856, 103136, 112416, },
    {3840, 15296, 25472, 35360, 44640, 54304, 64320, 74496, 84480, 94112, 103552, 113536, },
    {3840, 15328, 25536, 35712, 45024, 54720, 65024, 75232, 85248, 95040, 104384, 114528, },
    {3840, 15520, 25920, 36128, 45568, 55264, 65472, 76000, 86176, 95840, 105472, 115648, },
    {3840, 15552, 26240, 36352, 45952, 55680, 66176, 76608, 87104, 96800, 106304, 116640, },
    {3872, 15744, 26304, 36704, 46336, 56384, 66784, 77344, 87872, 97728, 107392, 117792, },
    {3872, 15904, 26624, 36928, 46720, 56800, 67360, 77952, 87968, 97984, 108384, 118944, },
    {3872, 15936, 26688, 37280, 47136, 57376, 67936, 78688, 88736, 98784, 109344, 119936, },
    {3872, 16096, 26144, 36768, 47520, 57920, 68512, 79296, 89504, 99712, 110304, 121056, },
    {3872, 16128, 26336, 37120, 47904, 58336, 69248, 80192, 90272, 100512, 111264, 122048, },
    {3872, 16288, 26528, 37344, 48288, 58880, 69696, 80800, 91040, 101440, 112224, 123168, },
    {3872, 16480, 26880, 37728, 48704, 59296, 70400, 81568, 91840, 102240, 113184, 124160, },
    {4032, 16672, 26944, 38080, 49088, 59840, 70848, 82304, 92608, 103168, 114144, 125280, },
    {4032, 16832, 27264, 38304, 49472, 60256, 71552, 82912, 93376, 103968, 115104, 126272, },
    {4032, 16864, 27328, 38656, 49856, 60800, 72000, 83648, 94144, 104928, 116224, 127392, },
    {4032, 17024, 27680, 38912, 50240, 61216, 72704, 84256, 94912, 105728, 117056, 128384, },
    {4032, 17056, 27872, 39264, 50624, 61792, 73312, 84992, 95680, 106656, 118144, 129536, },
    {4032, 17216, 28064, 39488, 51168, 62368, 73888, 85600, 96448, 107456, 118976, 130656, },
    {4032, 17248, 28256, 39840, 51552, 62784, 74624, 86368, 97216, 108384, 120064, 131648, },
    {4064, 17472, 28480, 40224, 52096, 63328, 75072, 87136, 98304, 109344, 120896, 132768, },
    {4064, 17632, 28800, 40448, 52480, 63744, 75776, 87744, 99072, 110144, 122016, 133920, },
    {4064, 17664, 28864, 40800, 52864, 64288, 76224, 88480, 99840, 111072, 122976, 135040, },
    {4064, 17824, 29184, 41024, 53248, 64704, 76928, 89088, 100608, 111872, 123936, 136032, },
    {4064, 17856, 29248, 41376, 53632, 65248, 77376, 89824, 101376, 112800, 124896, 137152, },
    {4064, 18016, 29568, 41600, 54016, 65664, 78080, 90432, 102144, 113600, 125856, 138144, },
    {4064, 18048, 29632, 41952, 54400, 66208, 78528, 91168, 102912, 114528, 126816, 139264, },
    {4064, 18208, 29952, 42176, 54784, 66624, 79232, 91776, 103680, 115328, 127776, 140256, },
};

// Size of the membership proof alone
std::size_t membership_proof_len(const std::size_t n_inputs, const uint8_t n_layers);

// Size of the FCMP++ proof (membership proof + spend-auth + linkability proofs & input tuples)
// https://github.com/kayabaNerve/fcmp-plus-plus/blob/78754718faa21f0a5751fbd30c9495d7f7f5c2b1/networks/monero/ringct/fcmp%2B%2B/src/lib.rs#L273-L274
std::size_t fcmp_pp_proof_len(const std::size_t n_inputs, const uint8_t n_layers);

//----------------------------------------------------------------------------------------------------------------------
}//namespace fcmp_pp
